%% HISTOGRAMA TIEMPO PWM 100 - SIN/CON FILTRO ANALOGO
clc
clear all
close all

tSF = [1000,1050,1100,1150,1200,1250,1300,1350,1400,1450,1500,1550,1600,1650,1700,1750,1799,1850,1900,1951,2123,2265,2354,2517,2588,2739,2905,2994,3046,3168,3277,3377,3471,3558,3641,3719,3795,3866,3934,4003,4067,4131,4191,4250,4309,4365,4419,4473,4525,4575,4625,4721,4771,4863,4954,5027,5083,5167,5250,5330,5408,5483,5558,5630,5701,5758,5826,5906,5973,6037,6101,6162,6225,6286,6347,6406,6464,6521,6577,6633,6690,6745,6799,6853,6907,6960,7013,7066,7120,7172,7225,7277,7331,7384,7436,7489,7542,7594,7647,7699,7752,7805,7858,7910,7962,8015,8068,8121,8173,8228,8281,8333,8386,8441,8493,8546,8598,8652,8705,8757,8810,8863,8916,8967,9020,9073,9127,9179,9231,9283,9336,9389,9442,9495,9548,9601,9654,9707,9761,9814,9866,9919,9973,10025,10078,10130,10183,10236,10289,10340,10393,10447,10500,10552,10604,10658,10709,10762,10815,10869,10921,10974,11027,11080,11134,11187,11239,11292,11346,11398,11451,11504,11557,11609,11662,11714,11768,11821,11873,11925,11979,12031,12082,12134,12187,12241,12293,12347,12400,12453,12506,12558,12611,12665,12718,12769,12823,12876,12929,12981,13033,13085,13139,13192,13245,13297,13350,13402,13454,13507,13561,13614,13666,13719,13773,13826,13879,13932,13985,14038,14091,14143,14197,14250,14302,14354,14407,14460,14512,14566,14618,14671,14724,14776,14827,14881,14935,14987,15039,15094,15147,15199,15253,15306,15359,15412,15464,15516,15570,15622,15674,15727,15780,15832,15885,15938,15991,16044,16096,16148,16200,16254,16307,16360,16411,16465,16519,16571,16624,16678,16731,16783,16836,16889,16942,16995,17047,17100,17153,17205,17257,17311,17364,17416,17469,17521,17573,17625,17678,17731,17784,17837,17891,17943,17997,18050,18103,18156,18209,18262,18315,18367,18421,18473,18525,18577,18630,18684,18737,18789,18841,18894,18946,18999,19052,19106,19157,19211,19264,19318,19371,19424,19476,19530,19583,19635,19688,19740,19794,19846,19899,19950,20004,20057,20110,20162,20215,20267,20319,20371,20426,20479,20530,20584,20637,20691,20744,20797,20849,20903,20956,21008,21061,21114,21167,21219,21271,21324,21377,21430,21483,21536,21588,21640,21691,21744,21798,21851,21902,21955,22009,22062,22115,22168,22221,22274,22327,22379,22433,22485,22538,22590,22642,22695,22748,22801,22853,22907,22959,23011,23063,23116,23170,23223,23274,23329,23382,23435,23488,23542,23594,23647,23699,23752,23805,23858,23910,23963,24016,24068,24121,24174,24227,24279,24332,24384,24437,24489,24542,24595,24647,24701,24754,24807,24860,24914,24967,25019.7333300000,25072.8484800000,25125.9636400000,25179.0787900000,25232.1939400000,25285.3090900000,25338.4242400000,25391.5393900000,25444.6545500000,25497.7697000000,25550.8848500000,25604,25657.1151500000,25710.2303000000,25763.3454500000,25816.4606100000,25869.5757600000,25922.6909100000,25975.8060600000,26028.9212100000,26082.0363600000,26135.1515200000,26188.2666700000,26241.3818200000,26294.4969700000,26347.6121200000,26400.7272700000,26453.8424200000,26506.9575800000,26560.0727300000,26613.1878800000,26666.3030300000,26719.4181800000,26772.5333300000,26825.6484800000,26878.7636400000,26931.8787900000,26984.9939400000,27038.1090900000,27091.2242400000,27144.3393900000,27197.4545500000,27250.5697000000,27303.6848500000,27356.8000000000,27409.9151500000,27463.0303000000,27516.1454500000,27569.2606100000,27622.3757600000,27675.4909100000,27728.6060600000,27781.7212100000,27834.8363600000,27887.9515200000,27941.0666700000,27994.1818200000,28047.2969700000,28100.4121200000,28153.5272700000,28206.6424200000,28259.7575800000];
tSF = (tSF'-tSF(1));

tCF = [1001,1051,1100,1150,1201,1251,1301,1351,1400,1451,1501,1551,1601,1651,1701,1751,1801,1851,1901,1952,2507,2735,2902,3041,3163,3272,3375,3468,3557,3640,3719,3794,3866,3935,4003,4067,4129,4190,4248,4307,4363,4417,4472,4524,4576,4626,4723,4817,4907,4996,5082,5166,5248,5326,5403,5481,5556,5629,5700,5770,5838,5905,5971,6036,6100,6162,6225,6285,6344,6405,6463,6521,6578,6633,6688,6743,6798,6851,6905,6957,7010,7064,7118,7171,7224,7276,7330,7382,7435,7488,7541,7593,7646,7698,7751,7804,7857,7910,7962,8015,8067,8120,8172,8226,8279,8331,8383,8439,8491,8544,8597,8651,8704,8756,8808,8861,8915,8967,9019,9072,9125,9178,9230,9283,9336,9389,9440,9493,9547,9600,9652,9704,9757,9812,9865,9918,9971,10024,10077,10129,10181,10236,10288,10340,10393,10446,10498,10551,10604,10657,10710,10762,10813,10866,10920,10973,11025,11077,11131,11185,11238,11291,11345,11397,11450,11502,11556,11609,11661,11713,11767,11819,11871,11924,11978,12030,12083,12135,12186,12240,12293,12346,12398,12451,12504,12558,12611,12665,12718,12770,12823,12876,12929,12982,13034,13086,13140,13192,13244,13297,13351,13403,13456,13508,13560,13613,13666,13718,13772,13824,13877,13931,13985,14037,14090,14143,14197,14249,14301,14354,14407,14460,14512,14565,14617,14671,14723,14776,14828,14882,14933,14986,15038,15091,15145,15197,15249,15304,15357,15410,15463,15516,15569,15622,15674,15727,15781,15832,15885,15938,15991,16043,16096,16149,16202,16254,16306,16359,16411,16465,16518,16570,16622,16677,16730,16783,16836,16890,16942,16995,17047,17101,17154,17205,17258,17310,17363,17416,17469,17522,17575,17627,17679,17732,17785,17838,17890,17943,17996,18050,18103,18156,18210,18263,18315,18368,18421,18474,18527,18578,18631,18685,18737,18790,18842,18896,18948,19001,19052,19106,19158,19211,19263,19317,19369,19423,19476,19530,19583,19636,19688,19741,19794,19847,19899,19952,20005,20057,20110,20163,20216,20269,20321,20373,20426,20479,20531,20584,20637,20690,20742,20797,20849,20904,20957,21009,21062,21115,21167,21220,21273,21326,21378,21431,21483,21537,21590,21642,21694,21747,21799,21852,21905,21957,22011,22063,22116,22170,22223,22276,22329,22382,22436,22488,22540,22594,22647,22699,22752,22804,22856,22910,22963,23015,23068,23121,23172,23225,23278,23332,23384,23436,23489,23544,23597,23650,23702,23756,23809,23861,23913,23966,24020,24072,24125,24177,24230,24283,24336,24388,24441,24494,24545,24598,24652,24704,24757,24809,24861,24917,24969,25021.4285700000,25074.3214300000,25127.2142900000,25180.1071400000,25233,25285.8928600000,25338.7857100000,25391.6785700000,25444.5714300000,25497.4642900000,25550.3571400000,25603.2500000000,25656.1428600000,25709.0357100000,25761.9285700000,25814.8214300000,25867.7142900000,25920.6071400000,25973.5000000000,26026.3928600000,26079.2857100000,26132.1785700000,26185.0714300000,26237.9642900000,26290.8571400000,26343.7500000000,26396.6428600000,26449.5357100000,26502.4285700000,26555.3214300000,26608.2142900000,26661.1071400000,26714,26766.8928600000,26819.7857100000,26872.6785700000,26925.5714300000,26978.4642900000,27031.3571400000,27084.2500000000,27137.1428600000,27190.0357100000,27242.9285700000,27295.8214300000,27348.7142900000,27401.6071400000,27454.5000000000,27507.3928600000,27560.2857100000,27613.1785700000,27666.0714300000,27718.9642900000,27771.8571400000,27824.7500000000,27877.6428600000,27930.5357100000,27983.4285700000,28036.3214300000,28089.2142900000];
tCF = (tCF'-tCF(1));

histogram(diff(tCF));

xlabel('Tiempo (ms)')
ylabel('Muestras')
title('Muestras vs Tiempo')
grid on

%% SEÑAL VELOCIDAD PWM 100 - SIN/CON FILTRO ANALOGO
clc
clear all
close all

tSF = [1000,1050,1100,1150,1200,1250,1300,1350,1400,1450,1500,1550,1600,1650,1700,1750,1799,1850,1900,1951,2123,2265,2354,2517,2588,2739,2905,2994,3046,3168,3277,3377,3471,3558,3641,3719,3795,3866,3934,4003,4067,4131,4191,4250,4309,4365,4419,4473,4525,4575,4625,4721,4771,4863,4954,5027,5083,5167,5250,5330,5408,5483,5558,5630,5701,5758,5826,5906,5973,6037,6101,6162,6225,6286,6347,6406,6464,6521,6577,6633,6690,6745,6799,6853,6907,6960,7013,7066,7120,7172,7225,7277,7331,7384,7436,7489,7542,7594,7647,7699,7752,7805,7858,7910,7962,8015,8068,8121,8173,8228,8281,8333,8386,8441,8493,8546,8598,8652,8705,8757,8810,8863,8916,8967,9020,9073,9127,9179,9231,9283,9336,9389,9442,9495,9548,9601,9654,9707,9761,9814,9866,9919,9973,10025,10078,10130,10183,10236,10289,10340,10393,10447,10500,10552,10604,10658,10709,10762,10815,10869,10921,10974,11027,11080,11134,11187,11239,11292,11346,11398,11451,11504,11557,11609,11662,11714,11768,11821,11873,11925,11979,12031,12082,12134,12187,12241,12293,12347,12400,12453,12506,12558,12611,12665,12718,12769,12823,12876,12929,12981,13033,13085,13139,13192,13245,13297,13350,13402,13454,13507,13561,13614,13666,13719,13773,13826,13879,13932,13985,14038,14091,14143,14197,14250,14302,14354,14407,14460,14512,14566,14618,14671,14724,14776,14827,14881,14935,14987,15039,15094,15147,15199,15253,15306,15359,15412,15464,15516,15570,15622,15674,15727,15780,15832,15885,15938,15991,16044,16096,16148,16200,16254,16307,16360,16411,16465,16519,16571,16624,16678,16731,16783,16836,16889,16942,16995,17047,17100,17153,17205,17257,17311,17364,17416,17469,17521,17573,17625,17678,17731,17784,17837,17891,17943,17997,18050,18103,18156,18209,18262,18315,18367,18421,18473,18525,18577,18630,18684,18737,18789,18841,18894,18946,18999,19052,19106,19157,19211,19264,19318,19371,19424,19476,19530,19583,19635,19688,19740,19794,19846,19899,19950,20004,20057,20110,20162,20215,20267,20319,20371,20426,20479,20530,20584,20637,20691,20744,20797,20849,20903,20956,21008,21061,21114,21167,21219,21271,21324,21377,21430,21483,21536,21588,21640,21691,21744,21798,21851,21902,21955,22009,22062,22115,22168,22221,22274,22327,22379,22433,22485,22538,22590,22642,22695,22748,22801,22853,22907,22959,23011,23063,23116,23170,23223,23274,23329,23382,23435,23488,23542,23594,23647,23699,23752,23805,23858,23910,23963,24016,24068,24121,24174,24227,24279,24332,24384,24437,24489,24542,24595,24647,24701,24754,24807,24860,24914,24967,25019.7333300000,25072.8484800000,25125.9636400000,25179.0787900000,25232.1939400000,25285.3090900000,25338.4242400000,25391.5393900000,25444.6545500000,25497.7697000000,25550.8848500000,25604,25657.1151500000,25710.2303000000,25763.3454500000,25816.4606100000,25869.5757600000,25922.6909100000,25975.8060600000,26028.9212100000,26082.0363600000,26135.1515200000,26188.2666700000,26241.3818200000,26294.4969700000,26347.6121200000,26400.7272700000,26453.8424200000,26506.9575800000,26560.0727300000,26613.1878800000,26666.3030300000,26719.4181800000,26772.5333300000,26825.6484800000,26878.7636400000,26931.8787900000,26984.9939400000,27038.1090900000,27091.2242400000,27144.3393900000,27197.4545500000,27250.5697000000,27303.6848500000,27356.8000000000,27409.9151500000,27463.0303000000,27516.1454500000,27569.2606100000,27622.3757600000,27675.4909100000,27728.6060600000,27781.7212100000,27834.8363600000,27887.9515200000,27941.0666700000,27994.1818200000,28047.2969700000,28100.4121200000,28153.5272700000,28206.6424200000,28259.7575800000];
tSF = (tSF'-tSF(1));
velSF = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4.47000000000000,29.3000000000000,30.8100000000000,27.5000000000000,52.7400000000000,26.7400000000000,7.18000000000000,10.9500000000000,19.1000000000000,13.6900000000000,10.2000000000000,18.9000000000000,24.0400000000000,34.6800000000000,22.5100000000000,14.3600000000000,25.3600000000000,31.9000000000000,21.9700000000000,28.1800000000000,23.3100000000000,18.0200000000000,18.8200000000000,32.4600000000000,39.0800000000000,40.4800000000000,27.9600000000000,35.5900000000000,29.0200000000000,38.1400000000000,30.7500000000000,23.7000000000000,23.3800000000000,32.7500000000000,37.8700000000000,44.2600000000000,56.9700000000000,48.0400000000000,32.2500000000000,28.4800000000000,29.3200000000000,30.3500000000000,30.7500000000000,31.6000000000000,32.3300000000000,51.2800000000000,65.4400000000000,61.0400000000000,42.1600000000000,59.5100000000000,48.0400000000000,49.8100000000000,43.3000000000000,37.4000000000000,50.4000000000000,44.9600000000000,39.5300000000000,40.2200000000000,40.9400000000000,54.9000000000000,61.0500000000000,62.1600000000000,49.4300000000000,42.7000000000000,42.7000000000000,43.2400000000000,58.0100000000000,65.2600000000000,50.2200000000000,43.8000000000000,43.7900000000000,44.0700000000000,43.2500000000000,57.7400000000000,51.3200000000000,43.7900000000000,43.5100000000000,58.8500000000000,65.6800000000000,51.3200000000000,43.7900000000000,42.9700000000000,43.8000000000000,44.3500000000000,44.3500000000000,43.7900000000000,43.5100000000000,43.5100000000000,44.0700000000000,56.7100000000000,49.9700000000000,58.0100000000000,65.2600000000000,50.2200000000000,43.8000000000000,58.2900000000000,50.7600000000000,58.0100000000000,65.2600000000000,80.8800000000000,58.5700000000000,43.5100000000000,72.5200000000000,59.1500000000000,44.0800000000000,58.0100000000000,64.4600000000000,50.9200000000000,44.3500000000000,59.1300000000000,80.1900000000000,72.5200000000000,79.7700000000000,58.0100000000000,43.5100000000000,58.0100000000000,50.7600000000000,43.5100000000000,57.2100000000000,64.8600000000000,51.3200000000000,43.7900000000000,42.9700000000000,43.8000000000000,43.7900000000000,58.8500000000000,65.6800000000000,65.2600000000000,50.7600000000000,44.6500000000000,44.0800000000000,42.9700000000000,57.7400000000000,51.3200000000000,44.3500000000000,43.2500000000000,44.3800000000000,44.0800000000000,43.5100000000000,57.2100000000000,65.7000000000000,51.1800000000000,43.5100000000000,72.5200000000000,71.7100000000000,50.3600000000000,43.5100000000000,44.0700000000000,43.2500000000000,43.8000000000000,58.2900000000000,50.7600000000000,58.0100000000000,51.3200000000000,58.2900000000000,51.3200000000000,43.2500000000000,43.2400000000000,44.0700000000000,44.3500000000000,57.4900000000000,50.9200000000000,44.9300000000000,59.4200000000000,50.6400000000000,57.7400000000000,66.1000000000000,64.8800000000000,64.8600000000000,50.7600000000000,58.0100000000000,66.1000000000000,51.1800000000000,42.9700000000000,43.2400000000000,44.6500000000000,43.5400000000000,43.2400000000000,43.5100000000000,44.0700000000000,44.3500000000000,44.3500000000000,57.4900000000000,64.8600000000000,65.2600000000000,51.3200000000000,43.7900000000000,58.0100000000000,66.9700000000000,66.1200000000000,50.2200000000000,43.2400000000000,44.0700000000000,43.7900000000000,57.2100000000000,50.3600000000000,43.5100000000000,43.5100000000000,43.5100000000000,58.0100000000000,50.7600000000000,58.8500000000000,50.6400000000000,43.2400000000000,44.0700000000000,43.7900000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,58.8500000000000,51.1800000000000,58.0100000000000,51.3200000000000,44.3500000000000,43.7900000000000,57.2100000000000,50.9200000000000,59.1300000000000,50.1200000000000,42.9800000000000,43.5100000000000,43.5100000000000,42.9700000000000,43.8000000000000,72.7900000000000,58.5700000000000,44.3500000000000,43.2500000000000,43.8000000000000,44.3500000000000,43.7900000000000,42.9700000000000,44.3800000000000,58.5800000000000,50.7600000000000,42.9700000000000,58.5800000000000,66.5200000000000,66.5200000000000,51.7400000000000,43.2500000000000,43.2400000000000,43.5100000000000,44.6500000000000,43.5400000000000,42.7000000000000,43.8000000000000,43.7900000000000,57.2100000000000,79.3600000000000,73.3500000000000,51.1800000000000,43.5100000000000,58.0100000000000,50.7600000000000,58.8500000000000,51.1800000000000,43.5100000000000,44.0700000000000,44.3500000000000,57.4900000000000,50.3600000000000,58.8500000000000,51.1800000000000,44.0700000000000,44.3500000000000,44.3500000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,42.9700000000000,43.8000000000000,57.4900000000000,50.3600000000000,58.0100000000000,65.2600000000000,50.7600000000000,58.0100000000000,50.7600000000000,44.0700000000000,43.2500000000000,58.5800000000000,51.7400000000000,44.3500000000000,72.7900000000000,71.7100000000000,50.3600000000000,44.0700000000000,59.1300000000000,51.1800000000000,44.0700000000000,43.7900000000000,43.5100000000000,42.9700000000000,59.4500000000000,51.0800000000000,43.2400000000000,42.9700000000000,43.2400000000000,58.0100000000000,51.3200000000000,43.2500000000000,43.2400000000000,44.0700000000000,43.7900000000000,58.8500000000000,50.6400000000000,43.8000000000000,43.7900000000000,59.7200000000000,51.0800000000000,43.2400000000000,43.5100000000000,44.0700000000000,43.7900000000000,44.0700000000000,44.3500000000000,43.7900000000000,42.9700000000000,43.2400000000000,44.0700000000000,43.7900000000000,43.5100000000000,42.9700000000000,43.2400000000000,43.5100000000000,58.8500000000000,50.6400000000000,43.2400000000000,44.0700000000000,43.7900000000000,43.5100000000000,58.0100000000000,51.3200000000000,44.3500000000000,43.7900000000000,43.5100000000000,72.5200000000000,72.5200000000000,50.7600000000000,44.0700000000000,44.3500000000000,44.9300000000000,44.0800000000000,57.2100000000000,64.8600000000000,66.9700000000000,51.6100000000000,42.9700000000000,43.2400000000000,43.5100000000000,58.0100000000000,50.7600000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.2500000000000,43.8000000000000,43.7900000000000,44.0700000000000,44.3500000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,59.1300000000000,51.7400000000000,43.7900000000000,57.2100000000000,50.3600000000000,74.7900000000000,72.0700000000000,49.9700000000000,43.5100000000000,72.5200000000000,57.4800000000000,43.8000000000000,43.7900000000000,58.8500000000000,65.6800000000000,50.7600000000000,43.5100000000000,44.0700000000000,43.7900000000000,43.5100000000000,44.0700000000000,43.7900000000000,58.0100000000000,65.2600000000000,51.3200000000000,43.7900000000000,44.0700000000000,43.7900000000000,44.0700000000000,43.7900000000000,58.0100000000000,51.3200000000000,71.7200000000000,57.4800000000000,43.5100000000000,43.5100000000000,42.9700000000000,43.2400000000000,44.0700000000000,43.7900000000000,42.4500000000000,42.4400000000000,42.1900000000000,55.1500000000000,48.0400000000000,41.1800000000000,40.2300000000000,39.7600000000000,38.8800000000000,50.6100000000000,57.3300000000000,44.0100000000000,72.6900000000000,61.3100000000000,39.2300000000000,34.7700000000000,57.3600000000000,45.5500000000000,55.2300000000000,43.3100000000000,41.8400000000000,46.7400000000000,35.8100000000000,29.8200000000000,29.0700000000000,28.5900000000000,27.7900000000000,27.0300000000000,35.1400000000000,46.5200000000000,41.2400000000000,27.9500000000000,23.2200000000000,38.4300000000000,29.8800000000000,35.2000000000000,27.9500000000000,20.9600000000000,20.0200000000000,19.5400000000000,31.7200000000000,24.8000000000000,29.7500000000000,34.7700000000000,33.7500000000000,21.9700000000000,26.4700000000000,29.9900000000000,28.0300000000000,34.7700000000000,38.1500000000000,24.3200000000000,12.7500000000000,9.66000000000000,8.67000000000000,7.53000000000000,9.42000000000000,17.3800000000000,34.6200000000000,34.9100000000000];

plot(tSF/1000, velSF*0.1047197551);
xlabel('Tiempo (s)')
ylabel('Velocidad (rad/s)')
title('Velocidad vs Tiempo')
grid on
hold on

tCF = [1001,1051,1100,1150,1201,1251,1301,1351,1400,1451,1501,1551,1601,1651,1701,1751,1801,1851,1901,1952,2507,2735,2902,3041,3163,3272,3375,3468,3557,3640,3719,3794,3866,3935,4003,4067,4129,4190,4248,4307,4363,4417,4472,4524,4576,4626,4723,4817,4907,4996,5082,5166,5248,5326,5403,5481,5556,5629,5700,5770,5838,5905,5971,6036,6100,6162,6225,6285,6344,6405,6463,6521,6578,6633,6688,6743,6798,6851,6905,6957,7010,7064,7118,7171,7224,7276,7330,7382,7435,7488,7541,7593,7646,7698,7751,7804,7857,7910,7962,8015,8067,8120,8172,8226,8279,8331,8383,8439,8491,8544,8597,8651,8704,8756,8808,8861,8915,8967,9019,9072,9125,9178,9230,9283,9336,9389,9440,9493,9547,9600,9652,9704,9757,9812,9865,9918,9971,10024,10077,10129,10181,10236,10288,10340,10393,10446,10498,10551,10604,10657,10710,10762,10813,10866,10920,10973,11025,11077,11131,11185,11238,11291,11345,11397,11450,11502,11556,11609,11661,11713,11767,11819,11871,11924,11978,12030,12083,12135,12186,12240,12293,12346,12398,12451,12504,12558,12611,12665,12718,12770,12823,12876,12929,12982,13034,13086,13140,13192,13244,13297,13351,13403,13456,13508,13560,13613,13666,13718,13772,13824,13877,13931,13985,14037,14090,14143,14197,14249,14301,14354,14407,14460,14512,14565,14617,14671,14723,14776,14828,14882,14933,14986,15038,15091,15145,15197,15249,15304,15357,15410,15463,15516,15569,15622,15674,15727,15781,15832,15885,15938,15991,16043,16096,16149,16202,16254,16306,16359,16411,16465,16518,16570,16622,16677,16730,16783,16836,16890,16942,16995,17047,17101,17154,17205,17258,17310,17363,17416,17469,17522,17575,17627,17679,17732,17785,17838,17890,17943,17996,18050,18103,18156,18210,18263,18315,18368,18421,18474,18527,18578,18631,18685,18737,18790,18842,18896,18948,19001,19052,19106,19158,19211,19263,19317,19369,19423,19476,19530,19583,19636,19688,19741,19794,19847,19899,19952,20005,20057,20110,20163,20216,20269,20321,20373,20426,20479,20531,20584,20637,20690,20742,20797,20849,20904,20957,21009,21062,21115,21167,21220,21273,21326,21378,21431,21483,21537,21590,21642,21694,21747,21799,21852,21905,21957,22011,22063,22116,22170,22223,22276,22329,22382,22436,22488,22540,22594,22647,22699,22752,22804,22856,22910,22963,23015,23068,23121,23172,23225,23278,23332,23384,23436,23489,23544,23597,23650,23702,23756,23809,23861,23913,23966,24020,24072,24125,24177,24230,24283,24336,24388,24441,24494,24545,24598,24652,24704,24757,24809,24861,24917,24969,25021.4285700000,25074.3214300000,25127.2142900000,25180.1071400000,25233,25285.8928600000,25338.7857100000,25391.6785700000,25444.5714300000,25497.4642900000,25550.3571400000,25603.2500000000,25656.1428600000,25709.0357100000,25761.9285700000,25814.8214300000,25867.7142900000,25920.6071400000,25973.5000000000,26026.3928600000,26079.2857100000,26132.1785700000,26185.0714300000,26237.9642900000,26290.8571400000,26343.7500000000,26396.6428600000,26449.5357100000,26502.4285700000,26555.3214300000,26608.2142900000,26661.1071400000,26714,26766.8928600000,26819.7857100000,26872.6785700000,26925.5714300000,26978.4642900000,27031.3571400000,27084.2500000000,27137.1428600000,27190.0357100000,27242.9285700000,27295.8214300000,27348.7142900000,27401.6071400000,27454.5000000000,27507.3928600000,27560.2857100000,27613.1785700000,27666.0714300000,27718.9642900000,27771.8571400000,27824.7500000000,27877.6428600000,27930.5357100000,27983.4285700000,28036.3214300000,28089.2142900000];
tCF = (tCF'-tCF(1));
velCF = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.08000000000000,5.06000000000000,6.90000000000000,8.29000000000000,9.45000000000000,10.3900000000000,11.4200000000000,12.4000000000000,12.9600000000000,13.8900000000000,14.5900000000000,15.3700000000000,16.0100000000000,16.7100000000000,16.9600000000000,18.0200000000000,18.3000000000000,19.2200000000000,19.8800000000000,19.5400000000000,20.5900000000000,20.9600000000000,21.3500000000000,22.1700000000000,22.1700000000000,23.0600000000000,23.7700000000000,24.5300000000000,25.6200000000000,25.9100000000000,26.8100000000000,27.4500000000000,28.1200000000000,29.5600000000000,29.9500000000000,29.5600000000000,30.7500000000000,31.5900000000000,32.4800000000000,32.9400000000000,33.4200000000000,34.9400000000000,34.9400000000000,35.4800000000000,36.0300000000000,37.1900000000000,36.6000000000000,38.4300000000000,39.0800000000000,37.8000000000000,39.7600000000000,39.7600000000000,40.4600000000000,41.9300000000000,41.9300000000000,41.1800000000000,42.7000000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,42.7000000000000,42.7000000000000,43.5100000000000,43.5100000000000,44.3500000000000,42.7000000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,61.7700000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,45.2200000000000,43.5100000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,41.9300000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,41.9300000000000,44.3500000000000,44.3500000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,45.2200000000000,43.5100000000000,42.7000000000000,43.5100000000000,66.5200000000000,43.5100000000000,43.5100000000000,42.7000000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,45.2200000000000,42.7000000000000,43.5100000000000,43.5100000000000,44.3500000000000,42.7000000000000,44.3500000000000,42.7000000000000,43.5100000000000,42.7000000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,42.7000000000000,44.3500000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,45.2200000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,41.9300000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,42.7000000000000,45.2200000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,41.9300000000000,43.5100000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,43.5100000000000,45.2200000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,66.5200000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,43.5100000000000,43.5100000000000,42.7000000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,44.3500000000000,43.5100000000000,45.2200000000000,42.7000000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,42.7000000000000,43.5100000000000,42.7000000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,41.9300000000000,44.3500000000000,41.9300000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,42.7000000000000,44.3500000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,45.2200000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,41.9300000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,45.2200000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,44.3500000000000,41.1800000000000,44.3500000000000,43.5100000000000,41.9300000000000,43.5100000000000,41.9300000000000,42.7000000000000,41.1800000000000,40.4600000000000,41.1800000000000,39.7600000000000,39.0800000000000,39.7600000000000,37.8000000000000,37.8000000000000,36.6000000000000,37.1900000000000,35.4800000000000,36.0300000000000,35.4800000000000,34.4200000000000,33.4200000000000,32.4800000000000,32.9400000000000,31.5900000000000,31.1600000000000,29.9500000000000,29.5600000000000,28.8300000000000,27.7800000000000,27.4500000000000,26.8100000000000,25.9100000000000,25.3400000000000,24.0200000000000,23.5300000000000,23.0600000000000,22.1700000000000,22.1700000000000,21.3500000000000,20.9600000000000,20.5900000000000,20.2300000000000,19.2200000000000,18.6000000000000,18.3000000000000,17.4700000000000,17.4700000000000,16.2400000000000,15.7900000000000,15.1700000000000,14.4100000000000,13.8900000000000,13.1000000000000,12.4000000000000,11.5300000000000,10.3900000000000,9.22000000000000,8.24000000000000,6.59000000000000,4.91000000000000];

plot(tCF/1000, velCF*0.1047197551);
xlabel('Tiempo (s)')
ylabel('Velocidad (rad/s)')
title('Velocidad vs Tiempo')
grid on

%% SEÑAL VELOCIDAD PWM 100 - SIN/CON FILTRO DIGITAL
clc
clear all
close all

tCF = [1001,1051,1100,1150,1201,1251,1301,1351,1400,1451,1501,1551,1601,1651,1701,1751,1801,1851,1901,1952,2507,2735,2902,3041,3163,3272,3375,3468,3557,3640,3719,3794,3866,3935,4003,4067,4129,4190,4248,4307,4363,4417,4472,4524,4576,4626,4723,4817,4907,4996,5082,5166,5248,5326,5403,5481,5556,5629,5700,5770,5838,5905,5971,6036,6100,6162,6225,6285,6344,6405,6463,6521,6578,6633,6688,6743,6798,6851,6905,6957,7010,7064,7118,7171,7224,7276,7330,7382,7435,7488,7541,7593,7646,7698,7751,7804,7857,7910,7962,8015,8067,8120,8172,8226,8279,8331,8383,8439,8491,8544,8597,8651,8704,8756,8808,8861,8915,8967,9019,9072,9125,9178,9230,9283,9336,9389,9440,9493,9547,9600,9652,9704,9757,9812,9865,9918,9971,10024,10077,10129,10181,10236,10288,10340,10393,10446,10498,10551,10604,10657,10710,10762,10813,10866,10920,10973,11025,11077,11131,11185,11238,11291,11345,11397,11450,11502,11556,11609,11661,11713,11767,11819,11871,11924,11978,12030,12083,12135,12186,12240,12293,12346,12398,12451,12504,12558,12611,12665,12718,12770,12823,12876,12929,12982,13034,13086,13140,13192,13244,13297,13351,13403,13456,13508,13560,13613,13666,13718,13772,13824,13877,13931,13985,14037,14090,14143,14197,14249,14301,14354,14407,14460,14512,14565,14617,14671,14723,14776,14828,14882,14933,14986,15038,15091,15145,15197,15249,15304,15357,15410,15463,15516,15569,15622,15674,15727,15781,15832,15885,15938,15991,16043,16096,16149,16202,16254,16306,16359,16411,16465,16518,16570,16622,16677,16730,16783,16836,16890,16942,16995,17047,17101,17154,17205,17258,17310,17363,17416,17469,17522,17575,17627,17679,17732,17785,17838,17890,17943,17996,18050,18103,18156,18210,18263,18315,18368,18421,18474,18527,18578,18631,18685,18737,18790,18842,18896,18948,19001,19052,19106,19158,19211,19263,19317,19369,19423,19476,19530,19583,19636,19688,19741,19794,19847,19899,19952,20005,20057,20110,20163,20216,20269,20321,20373,20426,20479,20531,20584,20637,20690,20742,20797,20849,20904,20957,21009,21062,21115,21167,21220,21273,21326,21378,21431,21483,21537,21590,21642,21694,21747,21799,21852,21905,21957,22011,22063,22116,22170,22223,22276,22329,22382,22436,22488,22540,22594,22647,22699,22752,22804,22856,22910,22963,23015,23068,23121,23172,23225,23278,23332,23384,23436,23489,23544,23597,23650,23702,23756,23809,23861,23913,23966,24020,24072,24125,24177,24230,24283,24336,24388,24441,24494,24545,24598,24652,24704,24757,24809,24861,24917,24969,25021.4285700000,25074.3214300000,25127.2142900000,25180.1071400000,25233,25285.8928600000,25338.7857100000,25391.6785700000,25444.5714300000,25497.4642900000,25550.3571400000,25603.2500000000,25656.1428600000,25709.0357100000,25761.9285700000,25814.8214300000,25867.7142900000,25920.6071400000,25973.5000000000,26026.3928600000,26079.2857100000,26132.1785700000,26185.0714300000,26237.9642900000,26290.8571400000,26343.7500000000,26396.6428600000,26449.5357100000,26502.4285700000,26555.3214300000,26608.2142900000,26661.1071400000,26714,26766.8928600000,26819.7857100000,26872.6785700000,26925.5714300000,26978.4642900000,27031.3571400000,27084.2500000000,27137.1428600000,27190.0357100000,27242.9285700000,27295.8214300000,27348.7142900000,27401.6071400000,27454.5000000000,27507.3928600000,27560.2857100000,27613.1785700000,27666.0714300000,27718.9642900000,27771.8571400000,27824.7500000000,27877.6428600000,27930.5357100000,27983.4285700000,28036.3214300000,28089.2142900000];
tCF = (tCF'-tCF(1));

velSF = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.08000000000000,5.06000000000000,6.90000000000000,8.29000000000000,9.45000000000000,10.3900000000000,11.4200000000000,12.4000000000000,12.9600000000000,13.8900000000000,14.5900000000000,15.3700000000000,16.0100000000000,16.7100000000000,16.9600000000000,18.0200000000000,18.3000000000000,19.2200000000000,19.8800000000000,19.5400000000000,20.5900000000000,20.9600000000000,21.3500000000000,22.1700000000000,22.1700000000000,23.0600000000000,23.7700000000000,24.5300000000000,25.6200000000000,25.9100000000000,26.8100000000000,27.4500000000000,28.1200000000000,29.5600000000000,29.9500000000000,29.5600000000000,30.7500000000000,31.5900000000000,32.4800000000000,32.9400000000000,33.4200000000000,34.9400000000000,34.9400000000000,35.4800000000000,36.0300000000000,37.1900000000000,36.6000000000000,38.4300000000000,39.0800000000000,37.8000000000000,39.7600000000000,39.7600000000000,40.4600000000000,41.9300000000000,41.9300000000000,41.1800000000000,42.7000000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,42.7000000000000,42.7000000000000,43.5100000000000,43.5100000000000,44.3500000000000,42.7000000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,61.7700000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,45.2200000000000,43.5100000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,41.9300000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,41.9300000000000,44.3500000000000,44.3500000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,45.2200000000000,43.5100000000000,42.7000000000000,43.5100000000000,66.5200000000000,43.5100000000000,43.5100000000000,42.7000000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,45.2200000000000,42.7000000000000,43.5100000000000,43.5100000000000,44.3500000000000,42.7000000000000,44.3500000000000,42.7000000000000,43.5100000000000,42.7000000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,42.7000000000000,44.3500000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,45.2200000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,41.9300000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,42.7000000000000,45.2200000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,41.9300000000000,43.5100000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,43.5100000000000,45.2200000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,66.5200000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,43.5100000000000,43.5100000000000,42.7000000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,42.7000000000000,44.3500000000000,43.5100000000000,45.2200000000000,42.7000000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,42.7000000000000,43.5100000000000,42.7000000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,41.9300000000000,44.3500000000000,41.9300000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,42.7000000000000,42.7000000000000,44.3500000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,43.5100000000000,44.3500000000000,44.3500000000000,42.7000000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,45.2200000000000,43.5100000000000,43.5100000000000,42.7000000000000,44.3500000000000,44.3500000000000,43.5100000000000,41.9300000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,44.3500000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.3500000000000,43.5100000000000,43.5100000000000,45.2200000000000,43.5100000000000,42.7000000000000,44.3500000000000,43.5100000000000,44.3500000000000,44.3500000000000,41.1800000000000,44.3500000000000,43.5100000000000,41.9300000000000,43.5100000000000,41.9300000000000,42.7000000000000,41.1800000000000,40.4600000000000,41.1800000000000,39.7600000000000,39.0800000000000,39.7600000000000,37.8000000000000,37.8000000000000,36.6000000000000,37.1900000000000,35.4800000000000,36.0300000000000,35.4800000000000,34.4200000000000,33.4200000000000,32.4800000000000,32.9400000000000,31.5900000000000,31.1600000000000,29.9500000000000,29.5600000000000,28.8300000000000,27.7800000000000,27.4500000000000,26.8100000000000,25.9100000000000,25.3400000000000,24.0200000000000,23.5300000000000,23.0600000000000,22.1700000000000,22.1700000000000,21.3500000000000,20.9600000000000,20.5900000000000,20.2300000000000,19.2200000000000,18.6000000000000,18.3000000000000,17.4700000000000,17.4700000000000,16.2400000000000,15.7900000000000,15.1700000000000,14.4100000000000,13.8900000000000,13.1000000000000,12.4000000000000,11.5300000000000,10.3900000000000,9.22000000000000,8.24000000000000,6.59000000000000,4.91000000000000];


plot(tCF/1000, velSF*0.1047197551);
xlabel('Tiempo (s)')
ylabel('Velocidad (rad/s)')
title('Velocidad vs Tiempo')
grid on
hold on

velCF = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.72000000000000,4.06000000000000,6.29000000000000,7.83000000000000,9.07000000000000,10.0800000000000,11.0700000000000,12.0700000000000,12.7700000000000,13.5800000000000,14.3600000000000,15.1100000000000,15.8000000000000,16.4800000000000,16.8700000000000,17.6600000000000,18.2100000000000,18.9100000000000,19.6600000000000,19.6500000000000,20.2400000000000,20.8400000000000,21.2200000000000,21.9000000000000,22.1700000000000,22.7600000000000,23.5400000000000,24.2800000000000,25.2600000000000,25.8100000000000,26.5100000000000,27.2400000000000,27.9000000000000,29.0800000000000,29.8200000000000,29.6900000000000,30.3500000000000,31.3100000000000,32.1800000000000,32.7900000000000,33.2600000000000,34.4300000000000,34.9400000000000,35.3000000000000,35.8500000000000,36.8100000000000,36.8000000000000,37.8200000000000,38.8700000000000,38.2300000000000,39.1100000000000,39.7600000000000,40.2200000000000,41.4400000000000,41.9300000000000,41.4300000000000,42.2000000000000,43.2400000000000,42.9700000000000,43.8000000000000,43.7900000000000,42.9700000000000,42.7000000000000,43.2400000000000,43.5100000000000,44.0700000000000,43.2500000000000,43.8000000000000,43.7900000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.7900000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.7900000000000,44.0700000000000,43.7900000000000,44.0700000000000,43.2500000000000,43.2400000000000,44.0700000000000,44.3500000000000,55.9600000000000,49.6000000000000,44.0700000000000,43.7900000000000,42.9700000000000,43.2400000000000,44.0700000000000,44.3500000000000,43.7900000000000,42.9700000000000,43.8000000000000,44.3500000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.7900000000000,43.5100000000000,44.6500000000000,44.0800000000000,42.9700000000000,43.2400000000000,44.0700000000000,44.3500000000000,43.7900000000000,42.4500000000000,42.9800000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,44.3500000000000,42.7300000000000,43.5400000000000,44.3500000000000,43.7900000000000,43.5100000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,44.9300000000000,44.0800000000000,42.9700000000000,43.2400000000000,58.8500000000000,51.1800000000000,43.5100000000000,42.9700000000000,43.2400000000000,43.5100000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,43.2500000000000,43.2400000000000,44.0700000000000,44.3500000000000,43.2500000000000,43.8000000000000,44.3500000000000,43.7900000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,44.9300000000000,43.5400000000000,43.2400000000000,43.5100000000000,44.0700000000000,43.2500000000000,43.8000000000000,43.2500000000000,43.2400000000000,42.9700000000000,43.2400000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,44.3500000000000,43.2500000000000,43.8000000000000,44.3500000000000,43.7900000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,44.3500000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.7900000000000,42.9700000000000,42.7000000000000,43.8000000000000,43.7900000000000,43.5100000000000,42.9700000000000,43.8000000000000,44.3500000000000,43.7900000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.7900000000000,44.0700000000000,43.2500000000000,43.8000000000000,43.7900000000000,44.0700000000000,43.2500000000000,44.3800000000000,44.0800000000000,44.0700000000000,43.7900000000000,42.9700000000000,43.8000000000000,44.3500000000000,42.7300000000000,42.9800000000000,43.5100000000000,43.5100000000000,43.5100000000000,42.9700000000000,43.8000000000000,44.3500000000000,43.7900000000000,42.9700000000000,44.3800000000000,44.0800000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,44.0700000000000,44.3500000000000,43.7900000000000,44.0700000000000,43.2500000000000,43.2400000000000,44.0700000000000,44.3500000000000,42.7300000000000,42.9800000000000,43.5100000000000,43.5100000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,43.2500000000000,43.2400000000000,44.6500000000000,44.0800000000000,44.0700000000000,43.7900000000000,42.9700000000000,58.5800000000000,51.1800000000000,43.5100000000000,44.0700000000000,44.3500000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.7900000000000,42.9700000000000,43.2400000000000,43.5100000000000,42.9700000000000,43.2400000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,44.3500000000000,43.2500000000000,43.8000000000000,43.7900000000000,44.0700000000000,43.2500000000000,43.8000000000000,43.7900000000000,44.6500000000000,43.5400000000000,43.8000000000000,43.7900000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.2500000000000,43.2400000000000,42.9700000000000,43.2400000000000,43.5100000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.7900000000000,43.5100000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.7900000000000,44.0700000000000,43.7900000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,44.0700000000000,42.7300000000000,43.5400000000000,42.7300000000000,42.9800000000000,44.0700000000000,43.7900000000000,43.5100000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,44.3500000000000,43.2500000000000,43.2400000000000,44.0700000000000,44.3500000000000,43.7900000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.7900000000000,42.9700000000000,42.7000000000000,43.8000000000000,43.7900000000000,43.5100000000000,42.9700000000000,43.8000000000000,44.3500000000000,43.2500000000000,43.2400000000000,44.0700000000000,43.7900000000000,44.0700000000000,44.3500000000000,43.2500000000000,43.2400000000000,44.0700000000000,43.7900000000000,43.5100000000000,44.6500000000000,44.0800000000000,43.5100000000000,42.9700000000000,43.8000000000000,44.3500000000000,43.7900000000000,42.4500000000000,42.9800000000000,43.5100000000000,43.5100000000000,43.5100000000000,43.5100000000000,44.0700000000000,44.3500000000000,43.7900000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.7900000000000,43.5100000000000,44.6500000000000,44.0800000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,44.3500000000000,42.2300000000000,43.2900000000000,43.7900000000000,42.4500000000000,42.9800000000000,42.4500000000000,42.4400000000000,41.6900000000000,40.7000000000000,40.9400000000000,40.2300000000000,39.3100000000000,39.5300000000000,38.4600000000000,37.8000000000000,37,37,36.0500000000000,35.8500000000000,35.6600000000000,34.7700000000000,33.7500000000000,32.7900000000000,32.7900000000000,32.0400000000000,31.3000000000000,30.3500000000000,29.6900000000000,29.0700000000000,28.1300000000000,27.5600000000000,27.0300000000000,26.2100000000000,25.5300000000000,24.4600000000000,23.6900000000000,23.2200000000000,22.4700000000000,22.1700000000000,21.6300000000000,21.0900000000000,20.7100000000000,20.3500000000000,19.5500000000000,18.8000000000000,18.4000000000000,17.7500000000000,17.4700000000000,16.6500000000000,15.9400000000000,15.3800000000000,14.6700000000000,14.0700000000000,13.3700000000000,12.6300000000000,11.8200000000000,10.7700000000000,9.61000000000000,8.57000000000000,7.14000000000000,5.47000000000000];

plot(tCF/1000, velCF*0.1047197551);
xlabel('Tiempo (s)')
ylabel('Velocidad (rad/s)')
title('Velocidad vs Tiempo')
grid on

%% HISTOGRAMA TIEMPO PWM VARIABLE - CON FILTRO ANALOGO y DIGITAL
clc
clear all
close all

tV = [1001,1051,1101,1151,1201,1251,1301,1351,1401,1450,1501,1551,1601,1651,1701,1751,1800,1851,1901,1951,2588,2790,2944,3079,3199,3304,3407,3508,3610,3711,3811,3909,4010,4112,4209,4315,4417,4518,4618,4719,4819,4921,5023,5124,5224,5325,5425,5524,5625,5726,5825,5928,6027,6127,6228,6328,6429,6529,6628,6728,6827,6926,7028,7129,7230,7330,7430,7531,7631,7732,7833,7932,8030,8129,8227,8327,8429,8528,8630,8731,8832,8933,9033,9131,9232,9335,9431,9539,9639,9739,9841,9941,10042,10139,10228,10312,10390,10466,10539,10610,10676,10742,10805,10867,10926,10983,11040,11095,11148,11201,11253,11303,11354,11404,11455,11508,11558,11609,11660,11711,11763,11814,11865,11915,11965,12017,12117,12169,12271,12322,12373,12425,12476,12527,12578,12629,12733,12785,12836,12887,12938,12989,13041,13093,13144,13195,13245,13297,13348,13399,13450,13500,13553,13604,13654,13705,13756,13807,13858,13909,13959,14010,14061,14112,14163,14214,14265,14317,14368,14419,14470,14520,14571,14622,14672,14773,14824,14875,14927,14978,15029,15081,15132,15182,15233,15285,15389,15440,15491,15542,15593,15646,15697,15748,15799,15850,15901,15952,16003,16054,16105,16157,16208,16259,16309,16360,16412,16462,16513,16563,16614,16665,16715,16767,16818,16869,16921,16971,17023,17073,17124,17176,17226,17276,17327,17427,17480,17530,17581,17632,17683,17736,17786,17836,17887,17939,17989,18043,18093,18190,18285,18376,18464,18549,18632,18713,18791,18868,18944,19017,19088,19159,19229,19297,19366,19434,19502,19570,19638,19707,19775,19834,19913,19980,20052,20121,20189,20259,20327,20396,20465,20533,20602,20670,20738,20807,20874,20943,21011,21080,21150,21217,21286,21352,21422,21490,21559,21628,21695,21764,21835,21904,21972,22042,22110,22179,22247,22316,22385,22453,22521,22589,22657,22726,22795,22863,22932,23000,23069,23135,23204,23272,23342,23411,23478,23547,23617,23686,23755,23824,23893,23962,24029,24098,24167,24235,24304,24372,24440,24508,24577,24646,24714,24783,24850,24918,24987,25055,25124,25192,25261,25329,25399,25469,25537,25607,25675,25743,25812,25881,25949,26018,26085,26152,26217,26281,26345,26408,26469,26530,26589,26646,26706,26763,26820,26876,26931,26985,27042,27095,27148,27201,27255,27307,27360,27412,27466,27519,27571,27623,27677,27728,27782,27834,27888,27940,27993,28044,28097,28151,28204,28256,28308,28362,28416,28469,28522,28576,28628,28681,28733,28787,28840,28892,28944,28998,29050,29102,29155,29209,29261,29314,29366,29418,29471,29524,29577,29629,29683,29735,29789,29842,29896,29949,30001,30054,30108,30160,30213,30265,30318,30371,30423,30475,30529,30582,30634,30687,30739,30792,30845,30897,30950,31004,31056,31108,31163,31216,31268,31321,31374,31428,31480,31532,31585,31638,31691,31743,31796,31848,31902,31955,32007,32060,32113,32164,32217,32270,32324,32376,32428,32481,32536,32589,32642,32695,32747,32801,32853,32906,32959,33012,33064,33117,33169,33222,33275,33328,33380,33434,33486,33537,33590,33643,33697,33749,33802,33854,33909,33962,34015,34068,34122,34177,34231,34287,34344,34400,34458,34517,34575,34635,34696,34759,34821,34886,34949,35014,35082,35150,35220,35291,35363,35437,35514,35592,35672,35754,35838,35922,36007,36092,36178,36263,36347,36432,36516,36601,36687,36771,36857,36942,37026,37109,37195,37280,37366,37451,37535,37620,37708,37793,37878,37965,38050,38135,38219,38305,38390,38475,38560,38644,38729,38813,38899,38984,39069,39154,39238,39322,39407,39492,39578,39663,39747,39832,39920,40005,40090,40177,40262,40347,40432,40517,40602,40687,40772,40856,40941,41025,41110,41195,41280,41365,41449,41533,41618,41703,41789,41874,41958,42043,42133,42224,42317,42414,42513,42565,42618,42671,42725,42783,42840,42899,42961,43023,43088,43154,43224,43296,43370,43448,43530,43613,43697,43781,43865,43948,44032,44116,44199,44283,44366,44449,44532,44614,44694,44778,44863,44945,45030,45115,45198,45284,45367,45448,45532,45617,45698,45787,45871,45955,46040,46123,46207,46291,46376,46460,46543,46627,46711,46795,46878,46961,47045,47129,47213,47295,47379,47463,47546,47630,47712,47795,47878,47961,48045,48130,48214,48297,48380,48465,48548,48632,48715,48798,48881,48964,49044,49128,49213,49295,49380,49465,49549,49634,49717,49799,49882,49967,50000,50120.7428600000,50203.1857100000,50285.6285700000,50368.0714300000,50450.5142900000,50532.9571400000,50615.4000000000,50697.8428600000];
tV = (tV'-tV(1));

histogram(diff(tV));

xlabel('Tiempo (ms)')
ylabel('Muestras')
title('Muestras vs Tiempo')
grid on

%% SEÑAL PWM VARIABLE
clc
clear all
close all

tV = [1001,1051,1101,1151,1201,1251,1301,1351,1401,1450,1501,1551,1601,1651,1701,1751,1800,1851,1901,1951,2588,2790,2944,3079,3199,3304,3407,3508,3610,3711,3811,3909,4010,4112,4209,4315,4417,4518,4618,4719,4819,4921,5023,5124,5224,5325,5425,5524,5625,5726,5825,5928,6027,6127,6228,6328,6429,6529,6628,6728,6827,6926,7028,7129,7230,7330,7430,7531,7631,7732,7833,7932,8030,8129,8227,8327,8429,8528,8630,8731,8832,8933,9033,9131,9232,9335,9431,9539,9639,9739,9841,9941,10042,10139,10228,10312,10390,10466,10539,10610,10676,10742,10805,10867,10926,10983,11040,11095,11148,11201,11253,11303,11354,11404,11455,11508,11558,11609,11660,11711,11763,11814,11865,11915,11965,12017,12117,12169,12271,12322,12373,12425,12476,12527,12578,12629,12733,12785,12836,12887,12938,12989,13041,13093,13144,13195,13245,13297,13348,13399,13450,13500,13553,13604,13654,13705,13756,13807,13858,13909,13959,14010,14061,14112,14163,14214,14265,14317,14368,14419,14470,14520,14571,14622,14672,14773,14824,14875,14927,14978,15029,15081,15132,15182,15233,15285,15389,15440,15491,15542,15593,15646,15697,15748,15799,15850,15901,15952,16003,16054,16105,16157,16208,16259,16309,16360,16412,16462,16513,16563,16614,16665,16715,16767,16818,16869,16921,16971,17023,17073,17124,17176,17226,17276,17327,17427,17480,17530,17581,17632,17683,17736,17786,17836,17887,17939,17989,18043,18093,18190,18285,18376,18464,18549,18632,18713,18791,18868,18944,19017,19088,19159,19229,19297,19366,19434,19502,19570,19638,19707,19775,19834,19913,19980,20052,20121,20189,20259,20327,20396,20465,20533,20602,20670,20738,20807,20874,20943,21011,21080,21150,21217,21286,21352,21422,21490,21559,21628,21695,21764,21835,21904,21972,22042,22110,22179,22247,22316,22385,22453,22521,22589,22657,22726,22795,22863,22932,23000,23069,23135,23204,23272,23342,23411,23478,23547,23617,23686,23755,23824,23893,23962,24029,24098,24167,24235,24304,24372,24440,24508,24577,24646,24714,24783,24850,24918,24987,25055,25124,25192,25261,25329,25399,25469,25537,25607,25675,25743,25812,25881,25949,26018,26085,26152,26217,26281,26345,26408,26469,26530,26589,26646,26706,26763,26820,26876,26931,26985,27042,27095,27148,27201,27255,27307,27360,27412,27466,27519,27571,27623,27677,27728,27782,27834,27888,27940,27993,28044,28097,28151,28204,28256,28308,28362,28416,28469,28522,28576,28628,28681,28733,28787,28840,28892,28944,28998,29050,29102,29155,29209,29261,29314,29366,29418,29471,29524,29577,29629,29683,29735,29789,29842,29896,29949,30001,30054,30108,30160,30213,30265,30318,30371,30423,30475,30529,30582,30634,30687,30739,30792,30845,30897,30950,31004,31056,31108,31163,31216,31268,31321,31374,31428,31480,31532,31585,31638,31691,31743,31796,31848,31902,31955,32007,32060,32113,32164,32217,32270,32324,32376,32428,32481,32536,32589,32642,32695,32747,32801,32853,32906,32959,33012,33064,33117,33169,33222,33275,33328,33380,33434,33486,33537,33590,33643,33697,33749,33802,33854,33909,33962,34015,34068,34122,34177,34231,34287,34344,34400,34458,34517,34575,34635,34696,34759,34821,34886,34949,35014,35082,35150,35220,35291,35363,35437,35514,35592,35672,35754,35838,35922,36007,36092,36178,36263,36347,36432,36516,36601,36687,36771,36857,36942,37026,37109,37195,37280,37366,37451,37535,37620,37708,37793,37878,37965,38050,38135,38219,38305,38390,38475,38560,38644,38729,38813,38899,38984,39069,39154,39238,39322,39407,39492,39578,39663,39747,39832,39920,40005,40090,40177,40262,40347,40432,40517,40602,40687,40772,40856,40941,41025,41110,41195,41280,41365,41449,41533,41618,41703,41789,41874,41958,42043,42133,42224,42317,42414,42513,42565,42618,42671,42725,42783,42840,42899,42961,43023,43088,43154,43224,43296,43370,43448,43530,43613,43697,43781,43865,43948,44032,44116,44199,44283,44366,44449,44532,44614,44694,44778,44863,44945,45030,45115,45198,45284,45367,45448,45532,45617,45698,45787,45871,45955,46040,46123,46207,46291,46376,46460,46543,46627,46711,46795,46878,46961,47045,47129,47213,47295,47379,47463,47546,47630,47712,47795,47878,47961,48045,48130,48214,48297,48380,48465,48548,48632,48715,48798,48881,48964,49044,49128,49213,49295,49380,49465,49549,49634,49717,49799,49882,49967,50000,50120.7428600000,50203.1857100000,50285.6285700000,50368.0714300000,50450.5142900000,50532.9571400000,50615.4000000000,50697.8428600000];
tV = (tV'-tV(1));
pwmVar = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,0,0,0,0,0,0,0,0,0];

stairs(tV/1000, pwmVar);
xlabel('Tiempo (s)')
ylabel('PWM (%)')
title('PWM vs Tiempo')
grid on

%% SEÑAL VELOCIDAD PWM VARIABLE
clc
clear all
close all

tV = [1001,1051,1101,1151,1201,1251,1301,1351,1401,1450,1501,1551,1601,1651,1701,1751,1800,1851,1901,1951,2588,2790,2944,3079,3199,3304,3407,3508,3610,3711,3811,3909,4010,4112,4209,4315,4417,4518,4618,4719,4819,4921,5023,5124,5224,5325,5425,5524,5625,5726,5825,5928,6027,6127,6228,6328,6429,6529,6628,6728,6827,6926,7028,7129,7230,7330,7430,7531,7631,7732,7833,7932,8030,8129,8227,8327,8429,8528,8630,8731,8832,8933,9033,9131,9232,9335,9431,9539,9639,9739,9841,9941,10042,10139,10228,10312,10390,10466,10539,10610,10676,10742,10805,10867,10926,10983,11040,11095,11148,11201,11253,11303,11354,11404,11455,11508,11558,11609,11660,11711,11763,11814,11865,11915,11965,12017,12117,12169,12271,12322,12373,12425,12476,12527,12578,12629,12733,12785,12836,12887,12938,12989,13041,13093,13144,13195,13245,13297,13348,13399,13450,13500,13553,13604,13654,13705,13756,13807,13858,13909,13959,14010,14061,14112,14163,14214,14265,14317,14368,14419,14470,14520,14571,14622,14672,14773,14824,14875,14927,14978,15029,15081,15132,15182,15233,15285,15389,15440,15491,15542,15593,15646,15697,15748,15799,15850,15901,15952,16003,16054,16105,16157,16208,16259,16309,16360,16412,16462,16513,16563,16614,16665,16715,16767,16818,16869,16921,16971,17023,17073,17124,17176,17226,17276,17327,17427,17480,17530,17581,17632,17683,17736,17786,17836,17887,17939,17989,18043,18093,18190,18285,18376,18464,18549,18632,18713,18791,18868,18944,19017,19088,19159,19229,19297,19366,19434,19502,19570,19638,19707,19775,19834,19913,19980,20052,20121,20189,20259,20327,20396,20465,20533,20602,20670,20738,20807,20874,20943,21011,21080,21150,21217,21286,21352,21422,21490,21559,21628,21695,21764,21835,21904,21972,22042,22110,22179,22247,22316,22385,22453,22521,22589,22657,22726,22795,22863,22932,23000,23069,23135,23204,23272,23342,23411,23478,23547,23617,23686,23755,23824,23893,23962,24029,24098,24167,24235,24304,24372,24440,24508,24577,24646,24714,24783,24850,24918,24987,25055,25124,25192,25261,25329,25399,25469,25537,25607,25675,25743,25812,25881,25949,26018,26085,26152,26217,26281,26345,26408,26469,26530,26589,26646,26706,26763,26820,26876,26931,26985,27042,27095,27148,27201,27255,27307,27360,27412,27466,27519,27571,27623,27677,27728,27782,27834,27888,27940,27993,28044,28097,28151,28204,28256,28308,28362,28416,28469,28522,28576,28628,28681,28733,28787,28840,28892,28944,28998,29050,29102,29155,29209,29261,29314,29366,29418,29471,29524,29577,29629,29683,29735,29789,29842,29896,29949,30001,30054,30108,30160,30213,30265,30318,30371,30423,30475,30529,30582,30634,30687,30739,30792,30845,30897,30950,31004,31056,31108,31163,31216,31268,31321,31374,31428,31480,31532,31585,31638,31691,31743,31796,31848,31902,31955,32007,32060,32113,32164,32217,32270,32324,32376,32428,32481,32536,32589,32642,32695,32747,32801,32853,32906,32959,33012,33064,33117,33169,33222,33275,33328,33380,33434,33486,33537,33590,33643,33697,33749,33802,33854,33909,33962,34015,34068,34122,34177,34231,34287,34344,34400,34458,34517,34575,34635,34696,34759,34821,34886,34949,35014,35082,35150,35220,35291,35363,35437,35514,35592,35672,35754,35838,35922,36007,36092,36178,36263,36347,36432,36516,36601,36687,36771,36857,36942,37026,37109,37195,37280,37366,37451,37535,37620,37708,37793,37878,37965,38050,38135,38219,38305,38390,38475,38560,38644,38729,38813,38899,38984,39069,39154,39238,39322,39407,39492,39578,39663,39747,39832,39920,40005,40090,40177,40262,40347,40432,40517,40602,40687,40772,40856,40941,41025,41110,41195,41280,41365,41449,41533,41618,41703,41789,41874,41958,42043,42133,42224,42317,42414,42513,42565,42618,42671,42725,42783,42840,42899,42961,43023,43088,43154,43224,43296,43370,43448,43530,43613,43697,43781,43865,43948,44032,44116,44199,44283,44366,44449,44532,44614,44694,44778,44863,44945,45030,45115,45198,45284,45367,45448,45532,45617,45698,45787,45871,45955,46040,46123,46207,46291,46376,46460,46543,46627,46711,46795,46878,46961,47045,47129,47213,47295,47379,47463,47546,47630,47712,47795,47878,47961,48045,48130,48214,48297,48380,48465,48548,48632,48715,48798,48881,48964,49044,49128,49213,49295,49380,49465,49549,49634,49717,49799,49882,49967,50000,50120.7428600000,50203.1857100000,50285.6285700000,50368.0714300000,50450.5142900000,50532.9571400000,50615.4000000000,50697.8428600000];
tV = (tV'-tV(1));
velV = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.60000000000000,4.43000000000000,6.90000000000000,8.19000000000000,9.25000000000000,10.5200000000000,11.1200000000000,11.3400000000000,11.3400000000000,11.3800000000000,11.4900000000000,11.6900000000000,11.5300000000000,11.3400000000000,11.6900000000000,11.2100000000000,11.1600000000000,11.3800000000000,11.4900000000000,11.4500000000000,11.4900000000000,11.3800000000000,11.2300000000000,11.4200000000000,11.5300000000000,11.4500000000000,11.4900000000000,11.6100000000000,11.4900000000000,11.4200000000000,11.5700000000000,11.3400000000000,11.5000000000000,11.5700000000000,11.4500000000000,11.4900000000000,11.4500000000000,11.4900000000000,11.6100000000000,11.5700000000000,11.6100000000000,11.6500000000000,11.4200000000000,11.3800000000000,11.4200000000000,11.4900000000000,11.5300000000000,11.4500000000000,11.4900000000000,11.4500000000000,11.4200000000000,11.5700000000000,11.7300000000000,11.6900000000000,11.7300000000000,11.6100000000000,11.3100000000000,11.5700000000000,11.4600000000000,11.3800000000000,11.4200000000000,11.4200000000000,11.4900000000000,11.6900000000000,11.5300000000000,11.2700000000000,11.7400000000000,11.1200000000000,11.2500000000000,11.5300000000000,11.3800000000000,11.4500000000000,11.4500000000000,11.7300000000000,12.6000000000000,13.4700000000000,14.4300000000000,15.0400000000000,15.5900000000000,16.0900000000000,17.0600000000000,17.4700000000000,18.0200000000000,18.5000000000000,19.2300000000000,20,20.2300000000000,20.7200000000000,21.4900000000000,21.7500000000000,22.0300000000000,22.7600000000000,22.7600000000000,22.9100000000000,22.7600000000000,22.0400000000000,22.6200000000000,22.7600000000000,22.6100000000000,22.6100000000000,22.3200000000000,22.4600000000000,22.6100000000000,22.9100000000000,23.0600000000000,22.4700000000000,22.7600000000000,22.4700000000000,22.4600000000000,22.6100000000000,22.3200000000000,22.4600000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.3200000000000,22.3200000000000,22.2400000000000,22.4600000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.3200000000000,22.1700000000000,22.4600000000000,22.6100000000000,22.9100000000000,22.4700000000000,22.4600000000000,22.6100000000000,22.6100000000000,22.9100000000000,22.1900000000000,22.3200000000000,22.9100000000000,22.7600000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.9100000000000,22.7600000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.3200000000000,22.4600000000000,22.6100000000000,22.6100000000000,22.9100000000000,22.7600000000000,22.6100000000000,22.9100000000000,22.9100000000000,22.6800000000000,22.6100000000000,22.3200000000000,22.4600000000000,22.6100000000000,37.1000000000000,29.8500000000000,22.9100000000000,22.7600000000000,22.3200000000000,22.1700000000000,22.4600000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.0400000000000,22.3200000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.3200000000000,22.4600000000000,22.6100000000000,22.9100000000000,22.7600000000000,22.3200000000000,22.7600000000000,22.7600000000000,22.9100000000000,22.7600000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.6100000000000,22.3200000000000,22.4600000000000,22.6100000000000,22.9100000000000,22.7600000000000,22.3200000000000,22.7600000000000,22.7600000000000,22.9100000000000,23.0600000000000,22.1900000000000,22.6200000000000,22.7600000000000,22.6100000000000,22.6100000000000,22.0400000000000,22.6200000000000,23.0600000000000,22.7600000000000,22.3200000000000,22.7600000000000,21.9200000000000,22.4900000000000,23.5400000000000,24.1100000000000,24.9900000000000,25.9200000000000,26.8200000000000,27.5700000000000,28.2400000000000,29.2000000000000,29.8200000000000,30.2100000000000,31.1700000000000,32.1800000000000,32.4800000000000,32.7900000000000,33.5900000000000,33.5800000000000,33.7500000000000,33.9100000000000,33.9100000000000,33.9100000000000,33.5800000000000,33.7500000000000,37.3600000000000,51.9500000000000,42.4100000000000,32.8200000000000,32.9600000000000,33.7500000000000,33.2700000000000,33.5900000000000,33.5800000000000,33.4200000000000,33.7500000000000,33.5800000000000,33.7500000000000,33.9100000000000,33.5800000000000,34.0900000000000,33.7500000000000,33.7500000000000,33.5800000000000,33.1000000000000,33.9300000000000,33.7500000000000,34.4300000000000,33.6100000000000,33.2600000000000,33.7500000000000,33.5800000000000,34.0900000000000,33.7500000000000,32.7900000000000,33.1100000000000,33.4200000000000,33.4200000000000,33.7500000000000,33.5800000000000,33.7500000000000,33.5800000000000,33.4200000000000,33.7500000000000,33.9100000000000,33.9100000000000,33.5800000000000,33.7500000000000,33.5800000000000,33.7500000000000,33.5800000000000,33.7500000000000,33.5800000000000,34.4300000000000,33.9300000000000,33.7500000000000,33.2700000000000,33.2600000000000,34.0900000000000,33.7500000000000,33.1000000000000,33.2600000000000,33.4200000000000,33.4200000000000,33.4200000000000,33.4200000000000,33.7500000000000,33.9100000000000,33.5800000000000,33.7500000000000,33.5800000000000,33.7500000000000,33.9100000000000,33.9100000000000,33.5800000000000,33.4200000000000,33.7500000000000,33.5800000000000,34.0900000000000,34.0800000000000,33.5800000000000,33.7500000000000,33.5800000000000,33.7500000000000,33.5800000000000,33.7500000000000,33.2700000000000,32.9400000000000,33.5900000000000,33.2700000000000,33.2600000000000,34.0900000000000,33.7500000000000,33.4200000000000,33.7500000000000,33.5800000000000,34.0900000000000,34.4200000000000,35.1200000000000,35.8500000000000,36.0300000000000,36.4100000000000,37.4000000000000,37.8000000000000,38.6600000000000,40,39.1100000000000,39.7800000000000,53.2400000000000,47.8300000000000,41.9300000000000,42.4400000000000,41.2100000000000,42.4900000000000,43.5100000000000,43.5100000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,43.2500000000000,43.2400000000000,44.0700000000000,44.3500000000000,43.2500000000000,44.3800000000000,43.5400000000000,43.8000000000000,43.2500000000000,43.8000000000000,43.7900000000000,44.6500000000000,44.0800000000000,42.9700000000000,43.2400000000000,44.0700000000000,44.3500000000000,43.2500000000000,42.7000000000000,43.2400000000000,43.5100000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,43.2500000000000,43.2400000000000,44.0700000000000,44.3500000000000,43.2500000000000,43.8000000000000,44.3500000000000,43.7900000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,44.3500000000000,43.7900000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.2500000000000,43.8000000000000,43.2500000000000,43.2400000000000,42.9700000000000,43.2400000000000,44.0700000000000,43.7900000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,43.7900000000000,43.5100000000000,44.0700000000000,44.3500000000000,43.2500000000000,43.2400000000000,44.0700000000000,43.7900000000000,44.0700000000000,43.7900000000000,43.5100000000000,44.0700000000000,43.7900000000000,42.9700000000000,43.8000000000000,44.3500000000000,42.7300000000000,42.9800000000000,44.0700000000000,43.7900000000000,43.5100000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,43.7900000000000,43.5100000000000,44.0700000000000,43.7900000000000,44.0700000000000,43.2500000000000,43.2400000000000,44.0700000000000,43.7900000000000,43.5100000000000,44.6500000000000,44.0800000000000,43.5100000000000,42.9700000000000,43.8000000000000,44.3500000000000,43.7900000000000,42.4500000000000,42.9800000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.2500000000000,43.8000000000000,43.7900000000000,58.0100000000000,50.7600000000000,44.0700000000000,43.7900000000000,44.0700000000000,43.7900000000000,43.5100000000000,43.5100000000000,44.0700000000000,43.2500000000000,43.8000000000000,44.3500000000000,44.3500000000000,43.7900000000000,42.9700000000000,43.8000000000000,43.7900000000000,44.0700000000000,42.7300000000000,42.9800000000000,43.5100000000000,43.5100000000000,42.9700000000000,42.1900000000000,42.4400000000000,41.6900000000000,40.7000000000000,40.9400000000000,40.2300000000000,39.3100000000000,39.5300000000000,38.8800000000000,38.0100000000000,37,37,36.0500000000000,36.2300000000000,35.8500000000000,34.4300000000000,33.9100000000000,33.2700000000000,32.6300000000000,32.1800000000000,31.4500000000000,30.3500000000000,29.6900000000000,29.0700000000000,28.3600000000000,27.6800000000000,27.4500000000000,27.2400000000000,27.1300000000000,26.9200000000000,27.0200000000000,27.3400000000000,27.2400000000000,27.3400000000000,27.2400000000000,26.9200000000000,27.0200000000000,27.1300000000000,27.1300000000000,27.3400000000000,27.6700000000000,27.1400000000000,27.0200000000000,26.9200000000000,27.0200000000000,27.3400000000000,27.2400000000000,26.5100000000000,26.8200000000000,26.9200000000000,26.8100000000000,27.0200000000000,27.1300000000000,27.3400000000000,27.0300000000000,27.0200000000000,27.1300000000000,27.1300000000000,27.3400000000000,27.2400000000000,27.1300000000000,27.1300000000000,27.1300000000000,27.1300000000000,27.1300000000000,27.3400000000000,27.4500000000000,27.2400000000000,27.1300000000000,26.9200000000000,27.0200000000000,27.3400000000000,27.2400000000000,26.5100000000000,26.8200000000000,26.9200000000000,26.8100000000000,27.0200000000000,27.1300000000000,27.1300000000000,27.1300000000000,27.1300000000000,27.1300000000000,27.1300000000000,27.3400000000000,27.2400000000000,27.3400000000000,27.2400000000000,27.1300000000000,27.1300000000000,27.1300000000000,27.3400000000000,27.4500000000000,27.2400000000000,27.1300000000000,26.9200000000000,27.0200000000000,27.3400000000000,27.2400000000000,26.1200000000000,25.4300000000000,24.9800000000000,24.1100000000000,23.4500000000000,22.5500000000000,21.8900000000000,21.7500000000000,21.4900000000000,20.3700000000000,20.1100000000000,19.7700000000000,18.9100000000000,18.6000000000000,18.0200000000000,17.5600000000000,16.8000000000000,16.1700000000000,15.7300000000000,15.0500000000000,14.3000000000000,13.9500000000000,13.7800000000000,13.7300000000000,13.7300000000000,13.8400000000000,13.7800000000000,13.7300000000000,13.8400000000000,13.7800000000000,13.8400000000000,13.8900000000000,13.8900000000000,14,14.0600000000000,14.0600000000000,13.7300000000000,13.9000000000000,13.7300000000000,13.5600000000000,13.6700000000000,13.6200000000000,13.7800000000000,14.1200000000000,13.9000000000000,13.6200000000000,14.0100000000000,13.3800000000000,13.3600000000000,13.7800000000000,13.6700000000000,13.7800000000000,13.7800000000000,13.6200000000000,13.6700000000000,13.7300000000000,13.8400000000000,13.7800000000000,13.7300000000000,13.7300000000000,13.8400000000000,13.8900000000000,13.7800000000000,13.7300000000000,13.7300000000000,13.9500000000000,13.8400000000000,13.7300000000000,13.8400000000000,13.7800000000000,13.9500000000000,13.9500000000000,13.8900000000000,13.8900000000000,13.7800000000000,13.6200000000000,13.6700000000000,13.8400000000000,13.8900000000000,13.6700000000000,13.7800000000000,13.7800000000000,13.8400000000000,13.8900000000000,13.8900000000000,13.8900000000000,14.2400000000000,13.9600000000000,13.6200000000000,13.9000000000000,13.7300000000000,13.5600000000000,22.8200000000000,18.1900000000000,13.7800000000000,14,13.9500000000000,13.6700000000000,13.9000000000000,12.8600000000000,12.1800000000000,11.5100000000000,10.5900000000000,9.63000000000000,8.51000000000000,7.15000000000000,5.45000000000000];

plot(tV/1000, velV*0.1047197551)
xlabel('Tiempo (s)')
ylabel('Velocidad (RPM)')
title('Velocidad vs Tiempo')
grid on

%% GRAFICA PWM VS VELOCIDAD MECANICA
clc
clear all
close all

velMeca = [0,2.62000000000000,4.91000000000000,7.22000000000000,9.56000000000000,11.5700000000000,13.7300000000000,16.0900000000000,18.4000000000000,20.3500000000000,22.7600000000000,25.1600000000000,26.9200000000000,29.1900000000000,31.4500000000000,33.5800000000000,35.8500000000000,38.2200000000000,40.2200000000000,42.2300000000000,43.8000000000000];
PWM = [0,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100];

plot(PWM, velMeca*0.1047197551)
xlabel('PWM (%)')
ylabel('Velocidad (rad/s)')
title('Velocidad vs PWM')
grid on



%% GRAFICA VELOCIDAD IDENTIFICACION 40 PWM
clc
clear all
close all

t40 = [1001,1051,1101,1150,1201,1251,1301,1351,1401,1450,1501,1551,1601,1651,1701,1751,1801,1851,1901,1951,2231,2599,2800,2955,3089,3207,3313,3411,3502,3588,3669,3746,3821,3891,3959,4025,4090,4153,4216,4279,4343,4406,4470,4532,4595,4657,4720,4781,4845,4908,4971,5035,5099,5162,5226,5289,5350,5413,5477,5539,5606,5670,5733,5797,5859,5923,5986,6051,6114,6177,6240,6303,6366,6429,6492,6556,6619,6683,6745,6808,6871,6934,6997,7060,7122,7184,7247,7310,7374,7437,7501,7563,7627,7690,7754,7816,7879,7941,8004,8064,8128,8192,8254,8318,8382,8445,8510,8572,8633,8696,8760,8822,8888,8953,9016,9080,9142,9206,9269,9334,9396,9460,9522,9586,9649,9712,9775,9838,9901,9965,10027,10090,10153,10215,10279,10341,10404,10467,10529,10593,10657,10719,10783,10845,10910,10972,11036,11098,11161,11223,11286,11347,11411,11474,11535,11600,11664,11728,11791,11854,11916,11979,12043,12105,12171,12236,12298,12362,12425,12489,12552,12616,12679,12742,12805,12869,12932,12995,13058,13121,13185,13248,13311,13374,13437,13499,13563,13625,13688,13750,13813,13876,13940,14003,14066,14129,14193,14256,14320,14382,14445,14507,14570,14630,14693,14758,14819,14884,14947,15000,15067.8571400000,15130.1428600000,15192.4285700000,15254.7142900000,15317,15379.2857100000,15441.5714300000,15503.8571400000,15566.1428600000,15628.4285700000,15690.7142900000,15753,15815.2857100000,15877.5714300000,15939.8571400000,16002.1428600000];
t40 = (t40'-t40(1));

histogram(diff(t40));

vel40 = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.75000000000000,3.46000000000000,4.87000000000000,6.87000000000000,8.22000000000000,9.38000000000000,10.5100000000000,11.4700000000000,12.3700000000000,13.1600000000000,13.9600000000000,14.7300000000000,15.2400000000000,16.1100000000000,16.7900000000000,17.3000000000000,17.6500000000000,18.1100000000000,18.3000000000000,18.3000000000000,18.1100000000000,18.2100000000000,18.1100000000000,18.4000000000000,18.4000000000000,18.5000000000000,18.4000000000000,18.7000000000000,18.3100000000000,18.0200000000000,18.4000000000000,18.2100000000000,18.0200000000000,18.2100000000000,18.1100000000000,18.2100000000000,18.7000000000000,18.5000000000000,17.9300000000000,18.5100000000000,17.7700000000000,17.7500000000000,18.2100000000000,18.1100000000000,18.2100000000000,18.3000000000000,18.3000000000000,17.9300000000000,18.1100000000000,18.3000000000000,18.3000000000000,18.3000000000000,18.3000000000000,18.3000000000000,18.1100000000000,18.2100000000000,18.3000000000000,18.1100000000000,18.4000000000000,18.4000000000000,18.3000000000000,30.5000000000000,24.4000000000000,18.3000000000000,18.5000000000000,18.6000000000000,18.4000000000000,18.3000000000000,18.1100000000000,18.2100000000000,18.1100000000000,18.4000000000000,18.2100000000000,18.2100000000000,18.1100000000000,18.4000000000000,18.4000000000000,18.5000000000000,18.4000000000000,18.9100000000000,18.4200000000000,18.0200000000000,18.4000000000000,18.2100000000000,18.0200000000000,18.2100000000000,17.9300000000000,18.3100000000000,18.8000000000000,18.5000000000000,18.1100000000000,18.4000000000000,17.6700000000000,17.7500000000000,18.2100000000000,18.1100000000000,18.4000000000000,18.2100000000000,18.2100000000000,17.9300000000000,18.3100000000000,18.2100000000000,18.4000000000000,18.2100000000000,18.2100000000000,18.3000000000000,18.3000000000000,18.3000000000000,18.3000000000000,18.1100000000000,18.4000000000000,18.4000000000000,18.3000000000000,18.5000000000000,18.2100000000000,18.4000000000000,18.4000000000000,18.3000000000000,18.5000000000000,18.2100000000000,18.0200000000000,18.4000000000000,18.2100000000000,18.4000000000000,18.0200000000000,18.3100000000000,18.2100000000000,18.4000000000000,18.4000000000000,18.5000000000000,18.4000000000000,18.7000000000000,18.3100000000000,18.2100000000000,18.7000000000000,18.1300000000000,17.9200000000000,18.0200000000000,18.2100000000000,18.3000000000000,18.5000000000000,18.4000000000000,18.1100000000000,18.4000000000000,17.8500000000000,17.6500000000000,18.3100000000000,18.2100000000000,18.2100000000000,18.1100000000000,18.2100000000000,18.1100000000000,18.2100000000000,18.1100000000000,18.4000000000000,18.2100000000000,18.2100000000000,18.3000000000000,18.3000000000000,18.3000000000000,18.1100000000000,18.2100000000000,18.3000000000000,18.3000000000000,18.3000000000000,18.5000000000000,18.2100000000000,18.4000000000000,18.4000000000000,18.5000000000000,18.4000000000000,18.3000000000000,18.1100000000000,18.2100000000000,18.1100000000000,18.4000000000000,18.2100000000000,18.2100000000000,18.1100000000000,18.4000000000000,18.4000000000000,18.5000000000000,18.4000000000000,18.9100000000000,18.6100000000000,17.9300000000000,18.5100000000000,18.1300000000000,18.1100000000000,18.4000000000000,17.9000000000000,17.4000000000000,17.1300000000000,16.6300000000000,15.6000000000000,15.3100000000000,13.9600000000000,13.2500000000000,12.7700000000000,11.9400000000000,11,10.0700000000000,8.99000000000000,7.73000000000000,6.26000000000000,4.07000000000000];

plot(t40/1000, vel40*0.1047197551)
xlabel('Tiempo (s)')
ylabel('Velocidad (Rad/s)')
title('Velocidad vs Tiempo - IDENTIFICACION 40 PWM')
grid on

%% SEÑAL VELOCIDAD VALIDACION 80 PWM
clc
clear all
close all

t80 = [1001,1051,1101,1151,1201,1251,1301,1351,1401,1451,1500,1551,1601,1651,1701,1751,1800,1851,1901,1951,2559,2772,2932,3069,3187,3293,3393,3487,3571,3658,3737,3812,3884,3952,4019,4084,4147,4207,4266,4323,4379,4434,4487,4539,4590,4640,4690,4785,4877,4965,5052,5136,5218,5299,5377,5452,5526,5598,5671,5740,5810,5877,5943,6008,6075,6140,6204,6270,6333,6398,6462,6527,6591,6656,6719,6784,6847,6911,6976,7040,7104,7169,7232,7296,7360,7425,7489,7555,7618,7682,7748,7813,7877,7943,8006,8071,8135,8200,8264,8328,8392,8457,8520,8584,8649,8713,8777,8842,8905,8968,9033,9098,9162,9227,9290,9355,9421,9486,9550,9615,9679,9744,9807,9872,9936,10001,10064,10129,10192,10257,10322,10386,10451,10515,10579,10641,10706,10770,10835,10899,10964,11027,11094,11158,11223,11287,11352,11416,11480,11544,11609,11673,11737,11801,11865,11929,11994,12058,12123,12186,12251,12313,12378,12442,12507,12571,12635,12699,12766,12830,12895,12959,13024,13088,13152,13216,13281,13345,13409,13473,13537,13601,13666,13730,13794,13858,13922,13985,14050,14114,14179,14243,14307,14370,14437,14501,14566,14632,14696,14760,14824,14889,14953,15000,15078.4210500000,15142.6526300000,15206.8842100000,15271.1157900000,15335.3473700000,15399.5789500000,15463.8105300000,15528.0421100000,15592.2736800000,15656.5052600000,15720.7368400000,15784.9684200000,15849.2000000000,15913.4315800000,15977.6631600000,16041.8947400000,16106.1263200000,16170.3578900000,16234.5894700000,16298.8210500000,16363.0526300000,16427.2842100000,16491.5157900000,16555.7473700000,16619.9789500000,16684.2105300000,16748.4421100000,16812.6736800000,16876.9052600000,16941.1368400000,17005.3684200000,17069.6000000000,17133.8315800000,17198.0631600000,17262.2947400000,17326.5263200000,17390.7578900000,17454.9894700000,17519.2210500000,17583.4526300000,17647.6842100000,17711.9157900000,17776.1473700000,17840.3789500000];
t80 = (t80'-t80(1));

histogram(diff(t80));

vel80 = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.26000000000000,4.24000000000000,6.61000000000000,8.01000000000000,9.32000000000000,10.5100000000000,11.3100000000000,12.0200000000000,13.2400000000000,13.4100000000000,14.1500000000000,15.1100000000000,15.8000000000000,16.6400000000000,17.1200000000000,17.5600000000000,18.1100000000000,18.9100000000000,19.4300000000000,20,20.4700000000000,20.8400000000000,21.4900000000000,22.0300000000000,22.4600000000000,22.9100000000000,23.0600000000000,23.8700000000000,24.8000000000000,25.6300000000000,26.5100000000000,27.2400000000000,27.6700000000000,28.4800000000000,29.3200000000000,30.3500000000000,31.0200000000000,31.7400000000000,31.7400000000000,32.8100000000000,33.1000000000000,33.9300000000000,34.4200000000000,35.4900000000000,34.9600000000000,35.1200000000000,35.8500000000000,35.3000000000000,36.0500000000000,35.8500000000000,35.8500000000000,35.6600000000000,35.8500000000000,35.6600000000000,36.2300000000000,35.8500000000000,36.2300000000000,35.8500000000000,35.8500000000000,36.0300000000000,36.0300000000000,35.6600000000000,36.2300000000000,36.2200000000000,36.0300000000000,35.6600000000000,35.8500000000000,35.3000000000000,36.0500000000000,36.2200000000000,35.3000000000000,47.1200000000000,41.7600000000000,35.3000000000000,36.0500000000000,35.8500000000000,35.8500000000000,35.6600000000000,35.8500000000000,35.6600000000000,36.2300000000000,35.8500000000000,36.2300000000000,36.2200000000000,35.6600000000000,35.8500000000000,36.0300000000000,35.6600000000000,36.2300000000000,36.6000000000000,35.8500000000000,35.4800000000000,35.8500000000000,35.6600000000000,36.2300000000000,35.8500000000000,35.1200000000000,35.3000000000000,35.8500000000000,35.6600000000000,35.8500000000000,35.6600000000000,36.2300000000000,35.8500000000000,35.8500000000000,35.6600000000000,36.2300000000000,35.8500000000000,36.2300000000000,35.8500000000000,35.4800000000000,35.8500000000000,35.6600000000000,35.8500000000000,36.0300000000000,36.8100000000000,36.0500000000000,35.8500000000000,35.6600000000000,35.8500000000000,35.6600000000000,36.2300000000000,35.1500000000000,35.4900000000000,35.6600000000000,35.8500000000000,35.6600000000000,35.8500000000000,36.0300000000000,36.0300000000000,35.6600000000000,35.8500000000000,36.0300000000000,36.0300000000000,36.0300000000000,36.0300000000000,35.6600000000000,35.8500000000000,35.6600000000000,36.2300000000000,35.8500000000000,36.6200000000000,36.0500000000000,35.8500000000000,35.6600000000000,35.8500000000000,36.0300000000000,36.0300000000000,34.9600000000000,47.5000000000000,41.6700000000000,35.8500000000000,35.6600000000000,35.8500000000000,36.0300000000000,36.0300000000000,35.6600000000000,35.8500000000000,36.0300000000000,36.0300000000000,36.0300000000000,36.0300000000000,35.6600000000000,35.8500000000000,36.0300000000000,36.0300000000000,36.0300000000000,36.4100000000000,35.8500000000000,35.8500000000000,35.6600000000000,35.8500000000000,36.0300000000000,36.4100000000000,35.1500000000000,35.4900000000000,35.6600000000000,35.1200000000000,35.6700000000000,36.0300000000000,36.0300000000000,35.6600000000000,35.8500000000000,36.0300000000000,36.0300000000000,34.9600000000000,34.7700000000000,34.2500000000000,33.2700000000000,32.6300000000000,31.8900000000000,31.3000000000000,31.1600000000000,30.6200000000000,29.3300000000000,28.3600000000000,27.9000000000000,27.1400000000000,26.4100000000000,25.8200000000000,23.9100000000000,23.7000000000000,23.0800000000000,22.9100000000000,22.7600000000000,22.0400000000000,21.4900000000000,20.8400000000000,20.8400000000000,20.2400000000000,19.4400000000000,19.2200000000000,18.6100000000000,17.9300000000000,17.3900000000000,16.8800000000000,16.1000000000000,15.5100000000000,14.8500000000000,14.1300000000000,13.4700000000000,12.6800000000000,11.9000000000000,10.9300000000000,9.93000000000000,8.90000000000000,7.51000000000000,5.92000000000000];

plot(t80/1000, vel80*0.1047197551)
xlabel('Tiempo (s)')
ylabel('Velocidad (Rad/s)')
title('Velocidad vs Tiempo - VALIDACION 80 PWM')
grid on

%% SEÑAL FRECUENCIA VS VOLTAJE VARIADOR

clc
clear all

frecuency = [0,1,2,3,4,5,10,15,20,25,30,35,40,45,50,55,60];
voltage = [0,19,22,25,28,31,46,62,79,96,114,132,149,167,185,202,220];

plot(frecuency, sqrt(2)*voltage)
xlabel('Frecuencia (Hz)')
ylabel('Voltaje (V)')
title('Voltaje vs Frecuencia')
grid on